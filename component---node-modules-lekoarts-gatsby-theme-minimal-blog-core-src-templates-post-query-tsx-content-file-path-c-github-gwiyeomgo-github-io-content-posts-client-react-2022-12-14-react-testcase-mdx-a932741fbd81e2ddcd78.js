"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[544],{2392:function(e,t,n){n.r(t),n.d(t,{Head:function(){return c.F},default:function(){return A}});var r=n(7294),l=n(1151);function s(e){const t=Object.assign({h3:"h3",p:"p",code:"code",ul:"ul",li:"li",pre:"pre",ol:"ol",a:"a",div:"div",h1:"h1"},(0,l.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.h3,null,"배경"),"\n",r.createElement(t.p,null,"golang 으로 api 개발을 할 때 테스트 케이스를 작성한다\r\nreact 로 어드민을 개발했었지만 testcase 를 어떻게 하는지 몰랐다\r\n그래서 npm 모듈을 만드는 과정에서 간단하게\r\n테스트 환경을 구성하고 버튼을 테스트 해보려고 했다\r\n그과정에서 발생했던 오류나 설치했던 내용을 정리하려고 한다"),"\n",r.createElement(t.h3,null,"React test 라이브러리"),"\n",r.createElement(t.p,null,"jsdom 라이브러리를 통해 실제 브라우저 DOM 을\r\n기준으로 테스트를 작성합니다.\r\n사용자 브라우저에 렌더링하는 실제 모습이 어떤지 테스트함\r\n(설치)",r.createElement(t.code,null,"npm i -D @testing-library/react")),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"주요 API","\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.code,null,"render()")),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"fireEvent :선택된 영역이 특정 이벤트를 발생시키기 위한 이벤트 함수")),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"screen")),"\n"),"\n"),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,"import {fireEvent,screen, render} from '@testing-library/react';\r\n\r\nrender(<ActivateButton\r\n title={'Click'}\r\n    ...\r\n/>);\r\n\r\nconst button = screen.getByRole('button', {name: 'Click'});\r\nfireEvent.click(button)\n")),"\n",r.createElement(t.p,null,"(참고)\r\n",r.createElement(t.code,null,"import userEvent from '@testing-library/user-event';"),"\r\n",r.createElement(t.code,null,"userEvent.click(button)")),"\n",r.createElement(t.h3,null,"Jest"),"\n",r.createElement(t.p,null,"React 의 테스팅 프레임워크 Jest\r\n(설치) ",r.createElement(t.code,null,"npm i -D jest"),"\r\n(package.json 에 script 추가)"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,'    "scripts": {\r\n        "test": "jest"\r\n        ...\r\n    },\r\n\n')),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.code,null,"describe() : test 그룹화")),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"it():  should do this thing")),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"test(): if it does this thing")),"\n"),"\n",r.createElement(t.h3,null,"테스팅 설정 파일 src/setupTests.js 설정 ?"),"\n",r.createElement(t.ol,null,"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,"setupTests.js 설정 안했다면  상단에 import"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"expect(button).toHaveProperty('disabled',false)"),"등 expect 를 사용했는데\r\n테스팅 설정 파일 없고  import 안해서 error 발생 했다."),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,"expect(...).toHaveAttribute is not a function\r\n TypeError: expect(...).toHaveAttribute is not a function\r\n-> The method toHaveAttribute is part of jest-dom\n")),"\n",r.createElement(t.p,null,r.createElement(t.code,null,'import "@testing-library/jest-dom/extend-expect";')," 상단에 import 추가하니 해결됨"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"expect(button).toHaveProperty('disabled',false)"),"\n",r.createElement(t.li,null,"expect(button).toBeInTheDocument();"),"\n"),"\n"),"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,"setupTests.js 설정"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"src/setupTests.js")," 추가하고 ",r.createElement(t.code,null,"import '@testing-library/jest-dom")," 추가함\r\n(package.json) 에 script 에 ",r.createElement(t.code,null,'"test": "jest"')," 실행시 jest-dom 못찾는다면\r\n",r.createElement(t.code,null,'"test2": "react-scripts test"')," script 를 추가하고 실행\r\n",r.createElement(t.a,{href:"https://stackoverflow.com/questions/53642594/setuptests-js-not-loading-automatically-in-cra-react-app"},"setupTests.js not loading automatically in CRA react app")),"\n"),"\n"),"\n",r.createElement(t.p,null,"(jest.config.js 에 setupFilesAfterEnv 추가)"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,'module.exports = {\r\n...\r\n  setupFilesAfterEnv: ["<rootDir>/src/setupTests.js"],\r\n};\r\n\n')),"\n",r.createElement(t.h3,null,r.createElement(t.a,{href:"https://testing-library.com/docs/react-testing-library/setup/#jest-28"},"If you're using Jest 28 or later, jest-environment-jsdom package now must be installed separatel")),"\n",r.createElement(t.p,null,"(설치)",r.createElement(t.code,null,"yarn add --dev jest-environment-jsdom"),"\r\n(jest.config.js 에 jsdom 추가)"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null," module.exports = {\r\n+  testEnvironment: 'jsdom',\r\n   // ... other options ...\r\n }\n")),"\n",r.createElement(t.p,null,"나는 이 부분을 몰라서 ",r.createElement(t.code,null,"TypeError: Cannot read properties of undefined (reading 'html')"),"\r\n에러가 났었고 ",r.createElement(t.a,{href:"https://github.com/facebook/jest/issues/12200#issuecomment-1004169335"},"검색"),"\r\n해서 jest-environment-jsdom 을 추가해야 한다는 것을 알게되었다"),"\n",r.createElement(t.h3,null,"unexpected token syntax error + import ... style.css 에서 에러 발생"),"\n",r.createElement(t.p,null,"스타일 시트를 import하는 부분에서 jest가 코드를 로딩함\r\n이 부분을 mock 으로 치환한다"),"\n",r.createElement(t.ol,null,"\n",r.createElement(t.li,null,"styleMock.ts 파일생성, 파일 안에 ",r.createElement(t.code,null,"export default {}")," 추가"),"\n",r.createElement(t.li,null,"jest.config.js 에 moduleNameMapper 에 mock 로 치환해주는 코드 추가"),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,'module.exports = {\r\n  ...\r\n  moduleNameMapper:{\r\n    "\\\\.(css|less)$": "<rootDir>/styleMock.ts"\r\n  }\r\n};\n')),"\n",r.createElement(t.h3,null,"typescript 에서 jest 를 사용하려면"),"\n",r.createElement(t.p,null,"(설치)",r.createElement(t.code,null,"npm i jest @types/jest ts-jest typescript -D"),"\r\n(jest.config.js)"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,"module.exports = {\r\n ...\r\n  testMatch: [\r\n    '<rootDir>/**/*.test.(js|jsx|ts|tsx)',\r\n    '<rootDir>/(tests/unit/**/*.spec.(js|jsx|ts|tsx)|**/__tests__/*.(js|jsx|ts|tsx))'\r\n  ],\r\n  transform: {\r\n    \"^.+\\\\.(ts|tsx)$\": \"ts-jest\"\r\n  },\r\n    ...\r\n};\n")),"\n",r.createElement(t.p,null,"(설치) ",r.createElement(t.code,null,"yarn add --dev @babel/preset-typescript"),"\r\n(설치) ",r.createElement(t.code,null,"yarn add --dev babel-jest @babel/core @babel/preset-env"),"\r\n(babel.config.js)"),"\n",r.createElement(t.pre,null,r.createElement(t.code,null,"module.exports = {\r\n    presets: [\r\n        ['@babel/preset-env'],\r\n    ],\r\n};\n")),"\n",r.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 436px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 67.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABzZqAD//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQACAwAAAAAAAAAAAAAAAAEAEBEhUf/aAAgBAQABPyFdxxwpY1//2gAMAwEAAgADAAAAEPAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARMVFxYaHR/9oACAEBAAE/ELULjW7EM9n2LbgdQ1DjfMS9XKn/2Q==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="jest"\n        title="jest"\n        src="/static/7c9b01a1f237f64172c5680f170307f5/36e95/jest_success.jpg"\n        srcset="/static/7c9b01a1f237f64172c5680f170307f5/46946/jest_success.jpg 240w,\n/static/7c9b01a1f237f64172c5680f170307f5/36e95/jest_success.jpg 436w"\n        sizes="(max-width: 436px) 100vw, 436px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",r.createElement(t.h1,null,"출처"),"\n",r.createElement(t.p,null,r.createElement(t.a,{href:"https://create-react-app.dev/docs/running-tests/#react-testing-library"},"https://create-react-app.dev/docs/running-tests/#react-testing-library"),"\r\n",r.createElement(t.a,{href:"https://stackoverflow.com/questions/69227566/consider-using-the-jsdom-test-environment"},"https://stackoverflow.com/questions/69227566/consider-using-the-jsdom-test-environment"),"\r\n",r.createElement(t.a,{href:"https://velog.io/@velopert/react-testing-library"},"https://velog.io/@velopert/react-testing-library"),"\r\n",r.createElement(t.a,{href:"https://tecoble.techcourse.co.kr/post/2021-10-22-react-testing-library/"},"https://tecoble.techcourse.co.kr/post/2021-10-22-react-testing-library/"),"\r\n",r.createElement(t.a,{href:"https://chinsun9.github.io/2021/08/07/start-jest-with-typescript/"},"https://chinsun9.github.io/2021/08/07/start-jest-with-typescript/"),"\r\n",r.createElement(t.a,{href:"https://jestjs.io/docs/getting-started#using-typescript"},"https://jestjs.io/docs/getting-started#using-typescript"),"\r\n",r.createElement(t.a,{href:"https://www.daleseo.com/react-testing-library/"},"https://www.daleseo.com/react-testing-library/"),"\r\n",r.createElement(t.a,{href:"https://stackoverflow.com/questions/65947682/expect-tohaveattribute-is-not-a-function-why"},"https://stackoverflow.com/questions/65947682/expect-tohaveattribute-is-not-a-function-why")))}var a=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?r.createElement(t,e,r.createElement(s,e)):s(e)},c=n(8804);function A(e){return r.createElement(c.Z,e,r.createElement(a,e))}c.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-c-github-gwiyeomgo-github-io-content-posts-client-react-2022-12-14-react-testcase-mdx-a932741fbd81e2ddcd78.js.map