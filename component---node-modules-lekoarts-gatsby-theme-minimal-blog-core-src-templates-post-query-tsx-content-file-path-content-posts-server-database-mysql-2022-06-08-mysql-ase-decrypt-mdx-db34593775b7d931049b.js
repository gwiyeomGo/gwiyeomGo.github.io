"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[2435],{226:function(e,n,l){l.r(n),l.d(n,{Head:function(){return E.F},default:function(){return m}});var t=l(7294),r=l(1151);function c(e){const n=Object.assign({h3:"h3",p:"p",h1:"h1",code:"code",ol:"ol",li:"li",ul:"ul",a:"a",blockquote:"blockquote",pre:"pre"},(0,r.ah)(),e.components);return t.createElement(t.Fragment,null,t.createElement(n.h3,null,"배경"),"\n",t.createElement(n.p,null,"현재 개발하고있는 시스템은\r\n회원의 휴대번호를 db에 암호화해서 보관한다."),"\n",t.createElement(n.p,null,"프로그램을 거처서 웹 화면에서 휴대번호를 볼때는\r\n복호화되어 휴대번호를 볼 수 있지만\r\n제플린과 같은 데이터만 조회 할 때 어떻게 알 수 있을까?"),"\n",t.createElement(n.h1,null,"암호키 찾기"),"\n",t.createElement(n.p,null,"block_encryption_mode 시스템 변수는 블록 기반 암호화 알고리즘의 모드를 제어한다!"),"\n",t.createElement(n.p,null,"0.",t.createElement(n.code,null,"select @@block_encryption_mode")," 를 검색"),"\n",t.createElement(n.ol,null,"\n",t.createElement(n.li,null,t.createElement(n.code,null,"SET @@session.block_encryption_mode = '{검색 결과}';")),"\n"),"\n",t.createElement(n.p,null,"블록 기반 암호화 알고리즘을 반환 !"),"\n",t.createElement(n.h1,null,"SET @@session 은 뭐지?"),"\n",t.createElement(n.h1,null,"mysql AES_DECRYPT"),"\n",t.createElement(n.p,null,"AES 알고리즘으로 데이터의 복호화\r\n",t.createElement(n.code,null,"AES_DECRYPT(,,)"),"\r\n",t.createElement(n.code,null,"AES_DECRYPT('암호화할 컬럼','암호화키', UNHEX(' 16진수 포맷 스트링'))")),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"HEX() 함수를 사용하면 스트링 또는 숫자를 16진수 포맷 스트링 으로 변경"),"\n",t.createElement(n.li,null,"UNHEX() 함수는 HEX로 된 값을 다시 복호화 디코딩을 수행해서 표시"),"\n",t.createElement(n.li,null,"유효하지 않은 데이터는 NULL을 반환"),"\n"),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://www.habonyphp.com/2019/02/aesencrypt-aesdecrypt.html"},"참고"),"\r\n",t.createElement(n.a,{href:"https://bluebreeze.co.kr/470"},"참고")),"\n",t.createElement(n.h1,null,"mysql base64 인코딩/디코딩"),"\n",t.createElement(n.p,null,"TO_BASE64\r\nFROM_BASE64"),"\n",t.createElement(n.blockquote,null,"\n",t.createElement(n.p,null,t.createElement(n.code,null,"SELECT TO_BASE64('test'), FROM_BASE64(TO_BASE64('test')) ;")),"\n"),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://database.guide/how-the-from_base64-function-works-in-mysql/"},"참고")),"\n",t.createElement(n.p,null,t.createElement(n.code,null,"FROM_BASE64(mobile 컬럼)")),"\n",t.createElement(n.h3,null,"mysql type casting"),"\n",t.createElement(n.p,null,"BINARY\r\nCAST\r\nCONVERT"),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"http://www.tcpschool.com/database/mysql/mysql_operator_typeCasting"},"참고")),"\n",t.createElement(n.p,null,t.createElement(n.code,null,"CAST(BINARY('암호화키') AS CHAR)"),"\r\n",t.createElement(n.code,null,"CAST('string' AS CHAR character set utf8)")," //convert a string to a different character set"),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://frody.tistory.com/92"},"참고")),"\n",t.createElement(n.h3,null,"mysql if , ifnull"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,'IFNULL(name, "null일 경우 대체 값")\r\nIF(name is null , "null일 경우 대체 값", name)\n')),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://velog.io/@gillog/DB-MySQL-NULL-%EC%B2%98%EB%A6%ACIFNULL-CASE-COALESCE"},"참고")),"\n",t.createElement(n.h3,null,"mysql 컬럼의 암호화 값을 복호화 한 경우"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"ifnull(\r\n    cast(\r\n        AES_DECRYPT(\r\n            FROM_BASE64('복호화 할 컬럼'),\r\n            CAST(BINARY('암호화 키') AS CHAR),\r\n            UNHEX('16진수 스트링')\r\n        )\r\n    as char character set utf8)\r\n,'복호화 할 컬럼')\n")),"\n",t.createElement(n.h1,null,"참고"),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://lhcsoft.blogspot.com/2019/03/mysql-mysql.html"},"https://lhcsoft.blogspot.com/2019/03/mysql-mysql.html")),"\n",t.createElement(n.h3,null,"실제 적용 상황"),"\n",t.createElement(n.p,null,"개발했던 api 에서 데이터가 2번 암호화된 값으로 저장되었다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"SELECT  id, mobile, ifnull(\r\ncast(AES_DECRYPT(FROM_BASE64(mobile),\r\nCAST(BINARY('암호화 키') AS CHAR),\r\nUNHEX('16진수 스트링')) as char character set utf8), mobile)\r\nas m from A\r\nWHERE mobile LIKE '/3%';\n")),"\n",t.createElement(n.p,null,"수습하기..\r\n복호화한 값을 다시 업데이트 한다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"UPDATE A\r\nSET mobile = ifnull(\r\n        cast(AES_DECRYPT(FROM_BASE64(mobile),\r\n        CAST(BINARY('암호화 키') AS CHAR),\r\n        UNHEX('16진수 스트링')) as char character set utf8), mobile)\r\nWHERE mobile LIKE '/3%' and id >0;\r\n\n")))}var a=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?t.createElement(n,e,t.createElement(c,e)):c(e)},E=l(8804);function m(e){return t.createElement(E.Z,e,t.createElement(a,e))}E.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-database-mysql-2022-06-08-mysql-ase-decrypt-mdx-db34593775b7d931049b.js.map