"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[6206],{6315:function(e,n,t){t.r(n),t.d(n,{Head:function(){return m.F},default:function(){return o}});var l=t(7294),r=t(1151);function a(e){const n=Object.assign({p:"p",h1:"h1",ul:"ul",li:"li",code:"code",pre:"pre",a:"a",h2:"h2",h3:"h3",ol:"ol"},(0,r.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.p,null,"Go 언어는 동시성(병행성) 지원한다."),"\n",l.createElement(n.h1,null,"Go Goroutine"),"\n",l.createElement(n.p,null,"go 루틴은 function 인데\r\n함수를 동시에 실행시킨다"),"\n",l.createElement(n.h1,null,"어떻게 사용?"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"go")," 키워드를 사용해 ",l.createElement(n.code,null,"gorutine"),"을 생성"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,'package main\r\n\r\nimport (\r\n\t"fmt"\r\n)\r\n\r\nfunc Call(name string) {\r\n\tfor i, _ := range name {\r\n\t\tfmt.Printf("%s-%v", name, i)\r\n\t}\r\n}\r\nfunc main() {\r\n\tfmt.Println("--start--")\r\n\tgo Call("tom")\r\n\tgo Call("coco")\r\n\tfmt.Println("--end--")\r\n}\n')),"\n",l.createElement(n.p,null,"main 함수가 끝나면\r\n모든 goroutine 도 끝난다."),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"//5초 후 main 함수 기다림\r\ntime.Sleep(time.Second * 5)\n")),"\n",l.createElement(n.p,null,"main 함수에서 5초간 지여니켰을때 결과를 확인해 보자"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"--start--\r\ncoco-0\r\ncoco-1\r\ncoco-2\r\ncoco-3\r\ntom-0\r\ntom-1\r\ntom-2\r\n--end--\n")),"\n",l.createElement(n.p,null,"이떄 호출 결과는 매번 같지 않다"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://replit.com/@gwiyeomgo/goroutine#zc79n4vs60yqfz5rkps9-go-1.17.3/share/go/src/fmt/print.go:273:5"},"예제코드")),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"time.Sleep"),"을 써서 코드를 실행을 지연시키는 방법 대신\r\n다른 방법은 없을까?"),"\n",l.createElement(n.h1,null,"고루틴을 제어하는 방식"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"WaitGroup 을 사용해 고루틴 종료 알림"),"\n",l.createElement(n.li,null,"Chanel 사용\r\n",l.createElement(n.a,{href:"https://jbhs7014.tistory.com/179"},"고루틴을 제어하는 방식에 대해 정리한 글이 있어서 공유")),"\n"),"\n",l.createElement(n.h2,null,"Chanel (=파이프)"),"\n",l.createElement(n.p,null,"Chanel 은 gorutine 이랑 main 함수 사이에서 정보를 전달해줄때\r\n사용할 수있다.\r\n연결 통로가 되어 메세지를 전달하거나 받는 역할을 한다."),"\n",l.createElement(n.h3,null,"어떻게 사용?"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"메세지를 보낸다 (매개변수로 전달)\r\n",l.createElement(n.code,null,"c := make(chan string)"),"\r\n",l.createElement(n.code,null,'go Call("tom",c)')),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"Call 함수는 메세지만 받음\r\n",l.createElement(n.code,null,"func hitUrl(url string ,c chan string)")),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"[이름] chan [메세지 타입]\r\n이때 메세지 타입은 struct 도 가능"),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"Call 함수는 메세지도 받고 c 사용해 메세지도 보낼 수 있다.\r\n",l.createElement(n.code,null,"func hitUrl(url string ,c chan<- string)")),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"main 함수로 메세지를 보낸다.\r\n",l.createElement(n.code,null,' c <- fmt.Sprintf("%s say yes",name)')),"\n"),"\n"),"\n",l.createElement(n.p,null,"main 함수는 메세지를 받을때까지 기다린다."),"\n",l.createElement(n.h1,null,l.createElement(n.a,{href:"https://go.dev/ref/spec#Channel_types"},"Channel types")),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"chan T          // can be used to send and receive values of type T\r\nchan<- float64  // can only be used to send float64s\r\n<-chan int      // can only be used to receive ints\n")),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://stackoverflow.com/questions/31920353/whats-the-difference-between-chan-and-chan-as-a-function-return-type"},"참고")),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,'package main\r\n\r\nimport (\r\n\t"fmt"\r\n)\r\n//매세지를 보낸다\r\nfunc Call(name string ,c chan string){\r\n\t//메세지를 받기만함\r\n\t//func Call(name string ,c <-chan string) {\r\n\tfor i, _ := range name {\r\n\t\tfmt.Printf("%s-%v\\n", name, i)\r\n\t}\r\n\tc <- fmt.Sprintf("%s say yes",name)\r\n}\r\nfunc main() {\r\n\tfmt.Println("--start--")\r\n\tc := make(chan string)\r\n\tgo Call("tom", c)\r\n\tgo Call("coco", c)\r\n\tresult:= <-c\r\n\tfmt.Println(result)\r\n\t//time.Sleep(time.Second * 5)\r\n\tfmt.Println("--end--")\r\n}\n')),"\n",l.createElement(n.h2,null,"실제업무에서 사용"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"우리서비스에서 dooray api 를 호출한다\r\n이때 호출을 기다릴 필요가 없으니 go 를 사용해서 호출"),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"sqs 로 메세지를 저장한다 sqs 를 호출해 메세지를 가져올때 while 문으로 go 루틴을 사용해 호출한다 이때 언제올지 모르는 결과값을 받기 위해 채널을 사용"),"\n"),"\n"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://replit.com/@gwiyeomgo/goroutineAndChanel#0yqfz5rkps9-go-1.17.3/share/go/src/builtin/builtin.go:71:5"},"실행예제")))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?l.createElement(n,e,l.createElement(a,e)):a(e)},m=t(8804);function o(e){return l.createElement(m.Z,e,l.createElement(c,e))}m.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-golang-2022-03-09-go-goroutine-mdx-cbde839c2ea91499621c.js.map