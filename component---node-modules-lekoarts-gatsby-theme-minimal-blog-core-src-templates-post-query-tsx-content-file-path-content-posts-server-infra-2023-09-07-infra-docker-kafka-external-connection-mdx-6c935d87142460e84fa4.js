"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[4288],{4159:function(e,n,t){t.r(n),t.d(n,{Head:function(){return m.F},default:function(){return o}});var l=t(7294),r=t(1151);function a(e){const n=Object.assign({h1:"h1",p:"p",hr:"hr",ul:"ul",li:"li",h3:"h3",ol:"ol",code:"code",pre:"pre",a:"a"},(0,r.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.h1,null,"배경"),"\n",l.createElement(n.p,null,"내 mac 에서 도컬를 실행하고 카프카 컨테이너를 실행했다\r\n옆사람이 pc 에서 내 카프카 컨테이너에 토픽을 생성하고 메세지를 받고싶다"),"\n",l.createElement(n.hr),"\n",l.createElement(n.h1,null,"방법1.Tunnels"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"다른 사용자의 pc 의 원격 호스트에 접속"),"\n"),"\n",l.createElement(n.h3,null,"SSH"),"\n",l.createElement(n.p,null,"사용자(클라이언트)와 서버(호스트)는 각각의 키를 보유하고 있으며 키를 이용해 연결 상대를 인증"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"authorized_keys 라는 파일에 접속할 pc 의 공개 키 전문을 저장"),"\n"),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"vim ~/.ssh/authorized_keys"),"  //실행 후 공개 키 전문을 저장"),"\n",l.createElement(n.ol,{start:"2"},"\n",l.createElement(n.li,null,"sshd_config 파일에 설정을 변경"),"\n"),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"sudo vim /etc/ssh/sshd_config ")," 명령어 실행 후 편집"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"PasswordAuthentication no\r\nUseDNS no\n")),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"패스워드 인증을 허용(yes)/허용안함(no)"),"\n",l.createElement(n.li,null,"클라이언트 호스트 주소를 DNS 해석(yes)/허용안함(no)"),"\n"),"\n",l.createElement(n.ol,{start:"3"},"\n",l.createElement(n.li,null,"앞에 설정을 완료 했다면 ssh [이름]@[ip] 로 상태방 pc 에 접근 가능"),"\n"),"\n",l.createElement(n.p,null,"(클라이언트 pc) ",l.createElement(n.code,null,"ssh -R 9092:127.0.0.1:9092 [서버 이름]@[서버 ip]")," 실행"),"\n",l.createElement(n.p,null,"(서버 pc) ",l.createElement(n.code,null,"ssh -L 9092:127.0.0.1:9092 [클라이언트 이름]@[클라이언트 ip]")," 실행"),"\n",l.createElement(n.ol,{start:"4"},"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"상대방 pc 터미널에 접근 성공"),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"이후 카프카에 토픽생성하고 메세지 추가"),"\n"),"\n"),"\n",l.createElement(n.p,null,"(클라이언트 pc) 카프카 서비스 코드를 실행해서 서버pc의 도커-카프카로 접근"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"pwd")," 명령어로 사용자 이름 확인"),"\n",l.createElement(n.li,null,"공개 키 생성(mac) -> ",l.createElement(n.code,null,"ssh-keygen -t -rsa -b 4096")),"\n",l.createElement(n.li,null,"공개 키 보기(mac) -> ",l.createElement(n.code,null,"cat ~/.ssh/id_rsa.pub")),"\n",l.createElement(n.li,null,"ip 확인 -> ",l.createElement(n.code,null,"ipconfig | grep inet")),"\n",l.createElement(n.li,null,"TCP/IP 네트워크로 루프백 주소 = 127.0.0.1 주소 = localhost 주소"),"\n"),"\n",l.createElement(n.hr),"\n",l.createElement(n.h1,null,"방법2.Kafka brokers"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"mac 에서 특정 host 에 kafka cluster dns 셋팅 방법"),"\n"),"\n",l.createElement(n.p,null,"가상의 호스트 이름 : kafka.example.com"),"\n",l.createElement(n.p,null,"1.호스트 파일(/etc/hosts) 편집\r\nMac에서 호스트 이름을 DNS로 해석하려면 먼저 /etc/hosts 파일에 해당 호스트 이름과 IP 주소의 매핑을 추가"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"sudo nano /etc/hosts\n")),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"##\r\n# Host Database\r\n#\r\n# localhost is used to configure the loopback interface\r\n# when the system is booting.  Do not change this entry.\r\n##\r\n\r\n192.168.1.100   kafka.example.com\n")),"\n",l.createElement(n.p,null,"Kafka 클러스터의 실제 IP 주소 = 192.168.1.100\r\n",l.createElement(n.code,null,"192.168.1.100 kafka.example.com"),"내용을 추가\r\n(nano) 저장: Ctrl + o , 나가기: Ctrl + x"),"\n",l.createElement(n.h1,null,"Kafka 클라이언트 설정 파일(server.properties)에 외부호스트 설정"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"advertised.listeners")," Kafka 브로커가 클라이언트에게 알려주는 브로커의 주소입니다. 주로 외부에서 접근 가능한 주소"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"advertised.listeners=PLAINTEXT://kafka.example.com:9092 //브로커의 주소 지정\r\n\n")),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://hanamon.kr/dns%EB%9E%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%84%A4%EC%9E%84-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EA%B0%9C%EB%85%90%EB%B6%80%ED%84%B0-%EC%9E%91%EB%8F%99-%EB%B0%A9%EC%8B%9D%EA%B9%8C%EC%A7%80/"},"https://hanamon.kr/dns란-도메인-네임-시스템-개념부터-작동-방식까지/"),"\r\n",l.createElement(n.a,{href:"https://blog.voidmainvoid.net/327"},"https://blog.voidmainvoid.net/327"),"\r\n",l.createElement(n.a,{href:"https://blog.voidmainvoid.net/500"},"https://blog.voidmainvoid.net/500"),"\r\n",l.createElement(n.a,{href:"https://mycup.tistory.com/428"},"https://mycup.tistory.com/428")),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://deep-dive-dev.tistory.com/42"},"https://deep-dive-dev.tistory.com/42"),"\r\n",l.createElement(n.a,{href:"https://devocean.sk.com/vlog/TechDay/03_se4.pdf"},"https://devocean.sk.com/vlog/TechDay/03_se4.pdf")),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://shinwusub.tistory.com/133"},"https://shinwusub.tistory.com/133")))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?l.createElement(n,e,l.createElement(a,e)):a(e)},m=t(8804);function o(e){return l.createElement(m.Z,e,l.createElement(c,e))}m.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-infra-2023-09-07-infra-docker-kafka-external-connection-mdx-6c935d87142460e84fa4.js.map