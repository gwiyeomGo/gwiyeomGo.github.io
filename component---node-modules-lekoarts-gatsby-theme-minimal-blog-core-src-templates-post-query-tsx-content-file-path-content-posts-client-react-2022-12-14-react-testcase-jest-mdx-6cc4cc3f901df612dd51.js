"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[2891],{8310:function(e,t,n){n.r(t),n.d(t,{Head:function(){return c.F},default:function(){return o}});var l=n(7294),r=n(1151);function s(e){const t=Object.assign({h3:"h3",p:"p",code:"code",ul:"ul",li:"li",pre:"pre",h1:"h1",a:"a",ol:"ol",hr:"hr",span:"span"},(0,r.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(t.h3,null,"배경"),"\n",l.createElement(t.p,null,"golang 으로 api 개발을 할 때 테스트 케이스를 작성한다\r\nreact 로 어드민을 개발했었지만 testcase 를 어떻게 하는지 몰랐다\r\n그래서 npm 모듈을 만드는 과정에서 간단하게\r\n테스트 환경을 구성하고 버튼을 테스트 해보려고 했다\r\n그과정에서 발생했던 오류나 설치했던 내용을 정리하려고 한다"),"\n",l.createElement(t.h3,null,"React test 라이브러리"),"\n",l.createElement(t.p,null,"jsdom 라이브러리를 통해 실제 브라우저 DOM 을\r\n기준으로 테스트를 작성합니다.\r\n사용자 브라우저에 렌더링하는 실제 모습이 어떤지 테스트함\r\n(설치)",l.createElement(t.code,null,"npm i -D @testing-library/react")),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"주요 API","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,l.createElement(t.code,null,"render()")),"\n",l.createElement(t.li,null,l.createElement(t.code,null,"fireEvent :선택된 영역이 특정 이벤트를 발생시키기 위한 이벤트 함수")),"\n",l.createElement(t.li,null,l.createElement(t.code,null,"screen")),"\n"),"\n"),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,"import {fireEvent,screen, render} from '@testing-library/react';\r\n\r\nrender(<ActivateButton\r\n title={'Click'}\r\n    ...\r\n/>);\r\n\r\nconst button = screen.getByRole('button', {name: 'Click'});\r\nfireEvent.click(button)\n")),"\n",l.createElement(t.p,null,"(참고)\r\n",l.createElement(t.code,null,"import userEvent from '@testing-library/user-event';"),"\r\n",l.createElement(t.code,null,"userEvent.click(button)")),"\n",l.createElement(t.h1,null,l.createElement(t.a,{href:"https://testing-library.com"},"react testing library")," 로 dom 을 렌더링 한다"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"create react app 으로 생성된 프로젝트는 테스트 라이브러리를 지원하여 설치하지 않아도 사용 할 수 있다.\r\n추가적으로 설치시 ",l.createElement(t.code,null,"npm install --save-dev @testing-library/react"),"로 설치"),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"행위 주도 테스트 입니다. 구현된 내부 보다 잘 동작되는지 확인"),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"dom ?\r\n=xml,html 문서의 각 항목을 계층으로 표현하여 생성,변형 삭제할 수 있도록 돕는 인터페이스?\r\n= html 이 브라우저의 렌더링 엔진에 의해 분석되고 분석이 끝난 html 파일"),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"웹 페이지 빌드 과정(crp) = 웹 브라우저가 html 문서를 읽고,스타일 입히고 뷰포트에 표시하는 과정"),"\n"),"\n"),"\n",l.createElement(t.h1,null,"렌더링 된 dom 을 jest 를 이용해서 테스트"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"jest = 테스팅 프레임 워크 = 단위 테스트를 위해 이용\r\n= 최소한의 설정으로 동작하며 테스트 케이스를 만들어서 어플리케아션 코드가 잘 동작하는지 확인"),"\n",l.createElement(t.li,null,"create react app 으로 생성된 프로젝트는 테스트 라이브러리를 지원하여 설치하지 않아도 사용 할 수 있다."),"\n",l.createElement(t.li,null,"설치 :",l.createElement(t.code,null,"npm install jest -save-dev")),"\n"),"\n",l.createElement(t.h1,null,"jest 가 파일을 어떻게 찾나요?"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,"1. (fileName).test.js\r\n2. (fileName).spec.js\r\n3. tests 폴더 생성시 안에 파일을 테스트 케이스로 인식\n")),"\n",l.createElement(t.p,null,"react 프로젝트의 터미널에서 ",l.createElement(t.code,null,"npm test")," 입력 실행 시 위 3가지 경우에 해당하는 파일들을 찾아 테스트함"),"\n",l.createElement(t.h1,null,"testing 예시"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'describe("name", () =>{ //테스트 그룹화\r\n    it("name",()=>{\r\n            ...    개별 테스트 수행\r\n\r\n        expect( 실행 코드 ).toBe()\r\n        //expect = 값을 테스트시 사용하며  matcher 랑 사용\r\n        // toBe ,toEqual 등 다양한 matcher 존재\r\n    })\r\n    test("name",()=>{\r\n            ...    개별 테스트 수행\r\n    })\r\n    // it = test\r\n})\n')),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'render(<Test/>) //`<Test/>` 컴포넌트를 렌더링 = dom의 컴포넌트를 렌터링 하는 함수\r\nconst element = screen.getByText("test") // test 텍스트를 갖은 요소를 찾음\r\nexpect(element).toBeInTheDocument()// 렌더링하여 컴포넌트 존재 여부 확인\n')),"\n",l.createElement(t.p,null,"=> ",l.createElement(t.a,{href:"https://testing-library.com/docs/ecosystem-jest-dom/"},"다양한 커스텀 함수들에 대한 설명")),"\n",l.createElement(t.h1,null,"query 함수  = 페이지에서 요소를 찾기 위한 함수"),"\n",l.createElement(t.h3,null,"Jest"),"\n",l.createElement(t.p,null,"React 의 테스팅 프레임워크 Jest\r\n(설치) ",l.createElement(t.code,null,"npm i -D jest"),"\r\n(package.json 에 script 추가)"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'    "scripts": {\r\n        "test": "jest"\r\n        ...\r\n    },\r\n\n')),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,l.createElement(t.code,null,"describe() : test 그룹화")),"\n",l.createElement(t.li,null,l.createElement(t.code,null,"it():  should do this thing")),"\n",l.createElement(t.li,null,l.createElement(t.code,null,"test(): if it does this thing")),"\n"),"\n",l.createElement(t.h3,null,"테스팅 설정 파일 src/setupTests.js 설정 ?"),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"setupTests.js 설정 안했다면  상단에 import"),"\n",l.createElement(t.p,null,l.createElement(t.code,null,"expect(button).toHaveProperty('disabled',false)"),"등 expect 를 사용했는데\r\n테스팅 설정 파일 없고  import 안해서 error 발생 했다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,"expect(...).toHaveAttribute is not a function\r\n TypeError: expect(...).toHaveAttribute is not a function\r\n-> The method toHaveAttribute is part of jest-dom\n")),"\n",l.createElement(t.p,null,l.createElement(t.code,null,'import "@testing-library/jest-dom/extend-expect";')," 상단에 import 추가하니 해결됨"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"expect(button).toHaveProperty('disabled',false)"),"\n",l.createElement(t.li,null,"expect(button).toBeInTheDocument();"),"\n"),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"setupTests.js 설정"),"\n",l.createElement(t.p,null,l.createElement(t.code,null,"src/setupTests.js")," 추가하고 ",l.createElement(t.code,null,"import '@testing-library/jest-dom")," 추가함\r\n(package.json) 에 script 에 ",l.createElement(t.code,null,'"test": "jest"')," 실행시 jest-dom 못찾는다면\r\n",l.createElement(t.code,null,'"test2": "react-scripts test"')," script 를 추가하고 실행\r\n",l.createElement(t.a,{href:"https://stackoverflow.com/questions/53642594/setuptests-js-not-loading-automatically-in-cra-react-app"},"setupTests.js not loading automatically in CRA react app")),"\n"),"\n"),"\n",l.createElement(t.p,null,"(jest.config.js 에 setupFilesAfterEnv 추가)"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'module.exports = {\r\n...\r\n  setupFilesAfterEnv: ["<rootDir>/src/setupTests.js"],\r\n};\r\n\n')),"\n",l.createElement(t.p,null,"react-toolkit 에 여러 컴포넌트를 추가하고 있다\r\n각 컴포넌트에 테스트 케이스를 작성 후 전체 테스트를 돌렸는다"),"\n",l.createElement(t.p,null,"heic2any 라이브러리를 사용안하는 컴포넌트에서 라이브러리를 heic2any 찾는 에러가 발생했다"),"\n",l.createElement(t.p,null,"정확한 원인은 아직 못 찾았는데\r\nsetupTests 에 모킹 코드를 옮기니 문제가 해결되었다."),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"다른 테스트에서 동일한 페이지 또는 컴포넌트를 렌더링하는 경우","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"테스트 간에 상태를 공유하지 않는 한 서로 영향을 주지 않습니다"),"\n",l.createElement(t.li,null,"Jest 및 Testing Library는 각각의 테스트 케이스가 격리되도록 설계"),"\n"),"\n"),"\n"),"\n",l.createElement(t.hr),"\n",l.createElement(t.h3,null,l.createElement(t.a,{href:"https://testing-library.com/docs/react-testing-library/setup/#jest-28"},"If you're using Jest 28 or later, jest-environment-jsdom package now must be installed separatel")),"\n",l.createElement(t.p,null,"(설치)",l.createElement(t.code,null,"yarn add --dev jest-environment-jsdom"),"\r\n(jest.config.js 에 jsdom 추가)"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null," module.exports = {\r\n+  testEnvironment: 'jsdom',\r\n   // ... other options ...\r\n }\n")),"\n",l.createElement(t.p,null,"나는 이 부분을 몰라서 ",l.createElement(t.code,null,"TypeError: Cannot read properties of undefined (reading 'html')"),"\r\n에러가 났었고 ",l.createElement(t.a,{href:"https://github.com/facebook/jest/issues/12200#issuecomment-1004169335"},"검색"),"\r\n해서 jest-environment-jsdom 을 추가해야 한다는 것을 알게되었다"),"\n",l.createElement(t.h3,null,"unexpected token syntax error + import ... style.css 에서 에러 발생"),"\n",l.createElement(t.p,null,"스타일 시트를 import하는 부분에서 jest가 코드를 로딩함\r\n이 부분을 mock 으로 치환한다"),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"styleMock.ts 파일생성, 파일 안에 ",l.createElement(t.code,null,"export default {}")," 추가"),"\n",l.createElement(t.li,null,"jest.config.js 에 moduleNameMapper 에 mock 로 치환해주는 코드 추가"),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'module.exports = {\r\n  ...\r\n  moduleNameMapper:{\r\n    "\\\\.(css|less)$": "<rootDir>/styleMock.ts"\r\n  }\r\n};\n')),"\n",l.createElement(t.h3,null,"typescript 에서 jest 를 사용하려면"),"\n",l.createElement(t.p,null,"(설치)",l.createElement(t.code,null,"npm i jest @types/jest ts-jest typescript -D"),"\r\n(jest.config.js)"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,"module.exports = {\r\n ...\r\n  testMatch: [\r\n    '<rootDir>/**/*.test.(js|jsx|ts|tsx)',\r\n    '<rootDir>/(tests/unit/**/*.spec.(js|jsx|ts|tsx)|**/__tests__/*.(js|jsx|ts|tsx))'\r\n  ],\r\n  transform: {\r\n    \"^.+\\\\.(ts|tsx)$\": \"ts-jest\"\r\n  },\r\n    ...\r\n};\n")),"\n",l.createElement(t.p,null,"(설치) ",l.createElement(t.code,null,"yarn add --dev @babel/preset-typescript"),"\r\n(설치) ",l.createElement(t.code,null,"yarn add --dev babel-jest @babel/core @babel/preset-env"),"\r\n(babel.config.js)"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,"module.exports = {\r\n    presets: [\r\n        ['@babel/preset-env'],\r\n    ],\r\n};\n")),"\n",l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 436px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 67.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABzZqAD//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQACAwAAAAAAAAAAAAAAAAEAEBEhUf/aAAgBAQABPyFdxxwpY1//2gAMAwEAAgADAAAAEPAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHhABAAIBBAMAAAAAAAAAAAAAARExABAhQXFhodH/2gAIAQEAAT8QlQtMXeIV7PuLLsB1k6HBfnEvU6f/2Q==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="jest"\n        title=""\n        src="/static/7c9b01a1f237f64172c5680f170307f5/36e95/jest_success.jpg"\n        srcset="/static/7c9b01a1f237f64172c5680f170307f5/46946/jest_success.jpg 240w,\n/static/7c9b01a1f237f64172c5680f170307f5/36e95/jest_success.jpg 436w"\n        sizes="(max-width: 436px) 100vw, 436px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",l.createElement(t.h3,null,"coverage 추가하기"),"\n",l.createElement(t.p,null,l.createElement(t.a,{href:"https://www.daleseo.com/jest-coverage/"},"https://www.daleseo.com/jest-coverage/"),"\r\n",l.createElement(t.a,{href:"https://www.daleseo.com/?tag=Jest"},"https://www.daleseo.com/?tag=Jest")),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"uncaught referenceerror: react is not defined 에러 발생시\r\n",l.createElement(t.a,{href:"https://velog.io/@chloedev/webpack-uncaught-referenceerror-react-is-not-defined-t8zot8bu"},"https://velog.io/@chloedev/webpack-uncaught-referenceerror-react-is-not-defined-t8zot8bu")),"\n"),"\n",l.createElement(t.p,null,"classnames\r\n",l.createElement(t.a,{href:"https://chanhuiseok.github.io/posts/react-14/"},"https://chanhuiseok.github.io/posts/react-14/")),"\n",l.createElement(t.p,null,"test\r\n",l.createElement(t.a,{href:"https://hu-coding.tistory.com/96"},"https://hu-coding.tistory.com/96"),"\r\n",l.createElement(t.a,{href:"https://react-hooks-testing-library.com/usage/basic-hooks"},"https://react-hooks-testing-library.com/usage/basic-hooks")),"\n",l.createElement(t.h1,null,"출처"),"\n",l.createElement(t.p,null,l.createElement(t.a,{href:"https://stackoverflow.com/questions/39641068/jest-trying-to-parse-css"},"https://stackoverflow.com/questions/39641068/jest-trying-to-parse-css"),"\r\n",l.createElement(t.a,{href:"https://stackoverflow.com/questions/54627028/jest-unexpected-token-when-importing-css"},"https://stackoverflow.com/questions/54627028/jest-unexpected-token-when-importing-css"),"\r\n",l.createElement(t.a,{href:"https://create-react-app.dev/docs/running-tests/#react-testing-library"},"https://create-react-app.dev/docs/running-tests/#react-testing-library"),"\r\n",l.createElement(t.a,{href:"https://stackoverflow.com/questions/69227566/consider-using-the-jsdom-test-environment"},"https://stackoverflow.com/questions/69227566/consider-using-the-jsdom-test-environment"),"\r\n",l.createElement(t.a,{href:"https://velog.io/@velopert/react-testing-library"},"https://velog.io/@velopert/react-testing-library"),"\r\n",l.createElement(t.a,{href:"https://tecoble.techcourse.co.kr/post/2021-10-22-react-testing-library/"},"https://tecoble.techcourse.co.kr/post/2021-10-22-react-testing-library/"),"\r\n",l.createElement(t.a,{href:"https://chinsun9.github.io/2021/08/07/start-jest-with-typescript/"},"https://chinsun9.github.io/2021/08/07/start-jest-with-typescript/"),"\r\n",l.createElement(t.a,{href:"https://jestjs.io/docs/getting-started#using-typescript"},"https://jestjs.io/docs/getting-started#using-typescript"),"\r\n",l.createElement(t.a,{href:"https://www.daleseo.com/react-testing-library/"},"https://www.daleseo.com/react-testing-library/"),"\r\n",l.createElement(t.a,{href:"https://stackoverflow.com/questions/65947682/expect-tohaveattribute-is-not-a-function-why"},"https://stackoverflow.com/questions/65947682/expect-tohaveattribute-is-not-a-function-why")))}var a=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,r.ah)(),e.components);return t?l.createElement(t,e,l.createElement(s,e)):s(e)},c=n(8804);function o(e){return l.createElement(c.Z,e,l.createElement(a,e))}c.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-client-react-2022-12-14-react-testcase-jest-mdx-6cc4cc3f901df612dd51.js.map