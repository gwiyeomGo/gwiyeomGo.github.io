---
title: redis 사용 경험
date: 2023-12-30
slug: "/mysql/2023-12-30-redis"
tags:
  - REDIS
  - 2023
---


redis 명령어 실습

레디스를 직접 설치해보고 레디스 서버를 띄운 뒤 레디스 cli 직접 활용

데이터 타입의 특집

레디스가 서버에 부하를 줄여주는
주의점




레디스 = 다수의 서버가 공유하는 해시 테이


레디스는 다수의 서버를 사용하는 분산 환경 서버가 공통으로 사용할 수 있는 해시 테이블
레디스는 Remote 서버 이다.=> 각각의 서버 안에 로컬하게 존재하지 않고 다수의 서버에서 공통적으로 사용할 수 있도록 원격에 존재한다는 의미
딕션어리라는 의미는 해시맵고 같이 키 밸류 형태로 상수의 시간 복잡도로 사용이 가능


오픈소스 인메모리 데이터 자장소 =>.
백업을 제외한 모든 데이터를 램에 저장
램은 디스크에 비해 매우 빠르기 때문에 레디스는 기본적인 관계형 데이터베이스와 다른 구조와 특징을 갖음

검증된 기술
데이터베이스중 대중성 높다

___

백업과 스냅샷에 디스크 일부를 사용하긴 하지만 이는 필수가 아니고 실제로 레디스 서버가 활용하는 데이터는 램에 저장
싱글 쓰레드기반 => 뛰어난 성능 자람함
사이드 이팩드 없는 안정적 기술
다중 노드에 데이터를 분산 저장하여 기본적으로 안정성과 고가용성을 제공


인메모리 데이터베이스라는 특성상 주로 휘발성 데이터를 저장하지만
rdb,aof 옵션을 활용하면 영속적으로 관리할 수도 있다.
pubSub 기술이 자체적으로 구현되어 있어서 이를 활용하면 실시간 채팅이나 알림 서비스와 같은
어플리케이션을 손쉽게 개발
_
장점
매우 높은 성능 => 매우 빠른 읽기 쓰기
다양한 데이터 타입 지원
다양한 언어에서 사용 가능

사용사례
1.캐싱
임시비밀번호나 로그인 세션과 같은 임시 데이터를 redisad에 캐싱하여 활용
2.레이트 리미터
보통 서버에서 특정 api에 대한 요청 횟수를 제한하기 위해 사용하는 기술 구현 가능
3. 메세지 브로커
레디스의 리스트나 스트림과 같은 데이터 타입을 활용하여 메시지 브로커를 구현하여 다양한 서비스 간의 커플링을 줄일 수 있다
4.실시간 분석 또는 계산
- 스코어에 따라 순위를 표시하는 순위표
- 지표를 이용한 반경 탐색
- 실시간 방문자수 계산
5.실시간 채팅
pub/sub 패턴 활

__

속성
1. 영속성
캐시로 사용되기 때문에 기본적으로 손실되어도 무방한 데이터를 기록해야 하지만
실제로 운영하다보면 캐시라도 손실되면 서비스에 지연이 발생하거나 장애 상황으로 이어지기도 합니다.

ssd 와 같은 연구 저장 장치에 데이터를 저장

rdb 옵션은 특정 시간에 스냅샷을 생성하는 기술
장애가 발생했을 때 특정 시점에 스냅샷으로 빠르게 캐시를 되돌리거나 동일한 데이터를 가진 캐시를 복제할 때 주로 사용
다만 스냅샷의 특성상 새로운 스냅샷이 생성되기 이전에 일부 데이터의 유실이 있을 수 있다.
스냅샷 생성중에 레디스 서버의 성능 저하가 발생하여 클라이언트 요청 처리에 지연이 발생할 수 있다

aop 옵션은 모든 라이트 작업을 모두 로그로 저장하는 기술
데이터 유실 없이 거의 모든 데이터에 싱크를 맞출 수 있지만 장애상황 재난복구 시에는 모든 로그를 다시 적용해야 하기 때문에
스냅샵 방식보다 복구되는 속도가 느립니다.


두옵션 같이 사용도 가능하고 사용자가 옵션을 선택해 사용
# 캐시


# Cache Hit /Miss


레디스와 같은 캐시 서버에 특정 키를 가진
캐시를 요청했을 때
정상적인 응답이 오는 경우 = 데이터 존재하는 경우
Cache Hit 표현

Cache Miss
키가 잘못되었거나 데이터가 이미 만료되어
데이터를 응답하지 못하는 경우

# Cache 전략
cache aside pattern
캐시어사이드 패턴

- 어플리케이션에서 클라이언트 요청을 처리할 때 먼저 캐시를 조회하여
캐시가 존재한다면 다시 말해 캐시 히트면 그래도 캐시를 사용하여 요청을 처리하되 캐시 미스인
경우 원본 스토리지에서 데이터를 조회하여 데이터를 캐싱하는 패턴



Redis 설치 (MacOS)
> https://redis.io/docs/getting-started/installation/install-redis-on-mac-os/

1. HomeBrew 설치
>  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

2. Redis 설치
>  brew install redis

3. Redis 실행
>  brew services start redis


3-1 실제로 레디스 서버에 어떤 명령어를 전달하기 위해서는 레디스 cli 라는 프로그램을 이용
> redis-cli

* 명령어는 대문자로 key,value 는 소문자
3-2 ping 명령어 전달시 pong 리턴 => redis 실행중이고 redis-cli 가 정상적으로 Redis 에 명령어 전달
> PING

3-3 값 저장 ,조회
> SET gwiyeom data
> GET gwiyeom

3-4 삭제
> DEL gwiyeom

4. Redis 종료
> brew services stop redis


# 데이터 타입에 따라 명령어가 다르다!
 SET myname gwiyeom
 Set 명령어는 string 타입
 Mset 명령어 : 멀티셋의 약자로 다수의 string 값 저장
    MSET price 100 name 치토스
    MGET myname price name
 INCR 별도의 인티저 타입 없이 스트링으로 숫자를 저장
 숫자의 형태의 스트링을 저장할 경우 별도의 더하기 빼기 연산이 가능
    INCR price
        1씩 증가
    INCRBY price 10
        숫자형 스트링의 값에 특정 값을 더할 때 사용 ,10 증가
제이슨 스트링도 저장
    SET gwiyeom '{"price":100, "name":"치토스"}'
    GET gwiyeom

키를 colon 을 이용해서 저장하는 것
    SET gwiyeom2:치토스:price 200
    GET gwiyeom2:치토스:price
    '200'
