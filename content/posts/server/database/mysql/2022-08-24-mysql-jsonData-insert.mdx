---
title: json 데이터 조회 경험 (How to search JSON data in MySQL?)
date: 2022-08-02
slug: "/database/mysql/2022-08-24-mysql-jsonData-insert"
tags:
  - MYSQL
---

## 배경

기부자가 택배는 보냈는데 신청 상태를 취소한 경우 처리 불가한 문제가 발생
ex) 기부자가 택배를 신청했는데 기부자가 자신의 기부를 취소한다

## 기획의 요청은..
`기부복원` 버튼을 생성하고 클릭시 상태가 변경된다
변경된 상태에서는 기부를 등록하고 취소할 수 있도록 변경요청

## db 에 영향을미치나?
statuses 테이블에는 전체 기부의 statuses를 기록하고있다
이부분에 새 상태를 추가해주는 작업이 필요해 보인다

다른 테이블을 살펴봐도 새 상태를 영향받는 테이블인 상태이력 테이블 하나로 확인

## 작업내용
statuses 에 복구 상태 추가 (DonationRestore)
```
INSERT INTO sharing.statuses (`status`, `name`, `order_by`, `receipt_available`, `created`, `updated`)
VALUES
('DonationRestored', '기부복구','95', '0', json_object(
'id', 1,
'name', '',
'role', '',
'member', '',
'datetime', DATE_FORMAT(NOW(),'%Y-%m-%d %h:%m:%s')
), json_object(
'id', 1,
'name', '',
'role', '',
'member', '',
'datetime', DATE_FORMAT(NOW(),'%Y-%m-%d %h:%m:%s')
));

```
상태를 복구 상태로 변경하는 API 추가
택배 기부 목록 화면에서 취소상태의 기부의 경우 복구 버튼이 보이도록 수정
택배 기부 목록 화면에서 복구상태의 기부의 경우 조회 버튼,등록 버튼,취소 버튼이 보이도록 수정
기부 등록,취소 API 를 확인하면서 복구상태에도 가능하도록 변경
어드민 상태 태그에 기부복구 추가

###


