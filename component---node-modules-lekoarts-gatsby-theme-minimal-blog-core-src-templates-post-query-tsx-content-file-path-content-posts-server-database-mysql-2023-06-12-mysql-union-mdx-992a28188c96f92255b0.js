"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[8321],{5514:function(n,e,t){t.r(e),t.d(e,{Head:function(){return s.F},default:function(){return i}});var l=t(7294),c=t(1151);function r(n){const e=Object.assign({h1:"h1",p:"p",pre:"pre",code:"code",ul:"ul",li:"li",a:"a"},(0,c.ah)(),n.components);return l.createElement(l.Fragment,null,l.createElement(e.h1,null,"배경"),"\n",l.createElement(e.p,null,"알림톡을 당일에 발송하는 API 는 회원을 조회한다"),"\n",l.createElement(e.p,null,"미전환 회원과 신규 회원을 각각 조회하며\n수신자를 수집하는데\n쿼리가 제대로 작동하는지 조회해봤다"),"\n",l.createElement(e.p,null,"총 구독자의 memberId 를 조회건에\n미전환 회원이 모두 포함되는지 보고싶었다"),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"SELECT distinct member_id FROM\nsubscribe_data as s\nwhere s.code  in(61,\n66,\n34,\n24,\n25,\n93,\n67);\n-- 1322 -> ids\n")),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"SELECT * FROM `members` WHERE `id`\nin (\nSELECT distinct member_id FROM\nsubscribe_data as s\nwhere s.code  in(61,\n66,\n34,\n24,\n25,\n93,\n67)\n)   ;\n-- 937 (미전환)\n")),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"select *\nwhere id in(\nSELECT distinct member_id FROM\nsubscribe_data as s\nwhere s.code  in(61,\n66,\n34,\n24,\n25,\n93,\n67)\n)\n ;\n-- 385 + 937  = 1322\n")),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"SELECT distinct member_id FROM\nsubscribe_data as s\nwhere s.code  in(\n61,\n66,\n34,\n24,\n25,\n93,\n67)\nunion\nSELECT id as member_id\nFROM `members` WHERE `id`\nin (\nSELECT distinct member_id FROM\nsubscribe_data as s\nwhere s.code  in(61,\n66,\n34,\n24,\n25,\n93,\n67)\n) ;\n")),"\n",l.createElement(e.p,null,"=> ids 갑 1322개의 값과 일치 미전환 회원이 모두 포함"),"\n",l.createElement(e.h1,null,"union"),"\n",l.createElement(e.p,null,"중복되지 않은 유일한 정보만 추출"),"\n",l.createElement(e.h1,null,"20230824 UNION ALL 사용해서 합치기"),"\n",l.createElement(e.p,null,"회원을 통합하면서 회원서비스를 분리했고 기존에 회원테이블과 신규테이블이 생성되었고\n총 회원수를 구하고 싶었다 (탈퇴 제외)"),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"-- SELECT count(*) as cnt FROM A\n-- 2\n\n-- SELECT count(*) as cnt FROM  B\n--3\n\nselect sum(a.cnt)\nfrom ((SELECT count(*) as cnt FROM A)\nUNION ALL\n(SELECT count(*) as cnt FROM  B )\n) as a;\n-- 5\n")),"\n",l.createElement(e.ul,null,"\n",l.createElement(e.li,null,"중복제거하지 않음 UNION ALL"),"\n",l.createElement(e.li,null,"최소 필요 컬럼만 SELECT 하기"),"\n"),"\n",l.createElement(e.p,null,l.createElement(e.a,{href:"https://donghodazzi.tistory.com/140"},"https://donghodazzi.tistory.com/140")))}var a=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,c.ah)(),n.components);return e?l.createElement(e,n,l.createElement(r,n)):r(n)},s=t(8804);function i(n){return l.createElement(s.Z,n,l.createElement(a,n))}s.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-database-mysql-2023-06-12-mysql-union-mdx-992a28188c96f92255b0.js.map