"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[3475],{8886:function(e,n,r){r.r(n),r.d(n,{Head:function(){return u.p},default:function(){return a}});var t=r(6540),l=r(8453);function s(e){const n=Object.assign({h3:"h3",p:"p",pre:"pre",code:"code",ul:"ul",li:"li",a:"a",h2:"h2"},(0,l.RP)(),e.components);return t.createElement(t.Fragment,null,t.createElement(n.h3,null,"20220511 베경"),"\n",t.createElement(n.p,null,"신청하는 API 를 만들었다.\n기관이 물품을 신청할 때\n신청 가능한지 확인하는 코드가 존재한다.\n이때 물품의 사업 분야와 기관의 사업 분야가 존재하며\n물품의 사업분야에 기관의 사업분야가 포함되어야 신청 할 수 있다."),"\n",t.createElement(n.h3,null,"작업 내용"),"\n",t.createElement(n.p,null,"물품의 사업 분야가 복수 일 때 기관의 사업 분야가 포함하는지 확인"),"\n",t.createElement(n.h3,null,"코드"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,'func Contains(items []string, key string) bool {\n\tfor _, item := range items {\n\t\tif item == key {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nif goods.BusinessField != "*" && org.BusinessField != goods.BusinessField {\n    return errors.ApiInternalServerError(fmt.Sprintf(errors.MessageParamsNotSame+"(사업분야:%d)", org.BusinessField))\n} else if goods.BusinessRegion != "00" && org.BusinessRegion != goods.BusinessRegion {\n    check := false\n    goodsBusinessFields := strings.Split(goods.BusinessField, ",")\n    orgBusinessFields := strings.Split(org.BusinessField, ",")\n    for _, orgBusinessField := range orgBusinessFields {\n        if common.Contains(goodsBusinessFields, orgBusinessField) {\n            check = true\n            break\n        }\n    }\n    if !check {\n        return errors.ApiInternalServerError(fmt.Sprintf(errors.MessageParamsNotSame+"(기관의 사업분야:%d)", org.BusinessField))\n    }\n}\n')),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"20221102"),"\n"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func StringSliceContains(s []string, e string) bool {\n\tfor _, a := range s {\n\t\tif a == e {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n")),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func Int64SliceContains(s []int64, e int64) bool {\n\tfor _, a := range s {\n\t\tif a == e {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\n")),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"Go 1.18+  부터는 generics 사용이 가능하다!"),"\n"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func Contains[T comparable](s []T, e T) bool {\n    for _, v := range s {\n        if v == e {\n            return true\n        }\n    }\n    return false\n}\n")),"\n",t.createElement(n.p,null,t.createElement(n.a,{href:"https://stackoverflow.com/questions/10485743/contains-method-for-a-slice"},"https://stackoverflow.com/questions/10485743/contains-method-for-a-slice")),"\n",t.createElement(n.h2,null,"20221209"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"if err != nil {\nreturn err\n}\n")),"\n",t.createElement(n.p,null,"코드를 go 작업하면서 자주 쓴다\n그래서 반복되는 코드를 함수로 만들고 utils 에 저장하고 사용한다"),"\n",t.createElement(n.p,null,"장점은 해당 코드는 3줄인데 아래처럼 1줄로 줄일 수 있다\n",t.createElement(n.code,null,"utils.HandlerErr(err)")),"\n",t.createElement(n.p,null,"function으로 작업을 하면서\n반환값에 boolean 이나 int 등 값또한 전달하는 상황이 있었다"),"\n",t.createElement(n.p,null,"id 로 값을 조회하는 function 의 경우\n반환값은 error 와 boolean 이다"),"\n",t.createElement(n.p,null,"// go 1.18 이후 제네릭 함수 사용 가능"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func HandleErr[T any](err error, b T) (error, T) {\n\tif err != nil {\n\t\treturn err, b\n\t}\n\treturn nil, nil\n}\n")),"\n",t.createElement(n.p,null,"여기서 문제는\n이 코드를 쓰면 아래와 같이\n",t.createElement(n.code,null,"cannot use nil as T value in return statement")," 에러가 발생한다\n타입이 T 인데 nil 을 반환해서 문제가 발생했다"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func HandleErr[T any](err error, b T) (error, T) {\n\tif err != nil {\n\t\treturn err, b\n\t}\n\treturn nil, b\n}\n")),"\n",t.createElement(n.p,null,"이렇게 코드를 고쳤고\n다시 테스트 케이스 커버를 확인하면서\n",t.createElement(n.code,null,"return nil,b")," 를 커버 못하는 것을 확인했다"),"\n",t.createElement(n.p,null,"그해서 아래처럼 변수에 할당을 해서 모든 코드가 실행되도록 수정하니 coverage 100 이 될 수 있었다"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"func HandleErrWithWant[T any](e error, w T) (error, T) {\n\tvar err error\n\tif e != nil {\n\t\terr = e\n\t}\n\treturn err, w\n}\n\n")))}var o=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.RP)(),e.components);return n?t.createElement(n,e,t.createElement(s,e)):s(e)},u=r(7292);function a(e){return t.createElement(u.A,e,t.createElement(o,e))}u.A}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-golang-2022-11-02-go-generics-mdx-c3a1dc8b36d7fffbfaf3.js.map