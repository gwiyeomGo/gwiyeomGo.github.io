"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[575],{7293:function(e,n,t){t.r(n),t.d(n,{Head:function(){return o.F},default:function(){return i}});var r=t(7294),l=t(1151);function a(e){const n=Object.assign({h1:"h1",p:"p",code:"code",ul:"ul",li:"li",pre:"pre",ol:"ol",a:"a"},(0,l.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(n.h1,null,"배경"),"\n",r.createElement(n.p,null,"현재 API 가 외부에도 노출되어 있기 때문에\r\nAPI 게이트웨이를 만들어서 특정 API 만 노출되도록 수정하려고 한다\r\n그전에 API 를 정리하기 위해서 swagger 를 적용하기로 했다."),"\n",r.createElement(n.p,null,"지금 echo 프레임워크 환경에서 swagger 를 설치하는 방법에 대해서 기록한다"),"\n",r.createElement(n.h1,null,"적용 방법"),"\n",r.createElement(n.p,null,"1.설치\r\n1-1 go annoations 활용하기 위한 설치\r\n",r.createElement(n.code,null,"go get -u github.com/swaggo/swag/cmd/swag")),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"(go 1.17 이상)",r.createElement(n.code,null,"go install github.com/swaggo/swag/cmd/swag@latest"),"\r\n1-2 echo 프레임워크를 사용한다면 echo 에서 동작하도록 하기 위한 설정\r\n",r.createElement(n.code,null,"go get -u github.com/swaggo/echo-swagger")," 설치 하고 아래 코드를 추가"),"\n"),"\n",r.createElement(n.pre,null,r.createElement(n.code,null,'func main() {\r\n    e := echo/New()\r\n        ...\r\n    e.GET("/swagger/*", echoSwagger.WrapHandler)\r\n}\n')),"\n",r.createElement(n.ol,{start:"3"},"\n",r.createElement(n.li,null,"각 API 에 annoations 추가한다"),"\n"),"\n",r.createElement(n.pre,null,r.createElement(n.code,null,'// @Summary\r\n// @Description 개\r\n// @Produce json\r\n// @Param name path string true "name of the user"\r\n// @Success 200 {object} map[string][]string\r\n// @Router / [post]\n')),"\n",r.createElement(n.ol,{start:"4"},"\n",r.createElement(n.li,null,r.createElement(n.code,null,"/docs")," 생성하고 swag 실행\r\n",r.createElement(n.code,null,"swag init")," 을 실행\r\n우리코드느 main.go 가 아니라 application.go 로 쓰고 있어서\r\n",r.createElement(n.code,null,"swag init -g application.go")," 처럼 실행코드를 지정햇다\r\ndocs 폴더가 생기고 내부에 swagger.json에서 ui 를 미리보기 할 수 있다\r\n(질문) 이 명령을 매번 계속 실행해야 하나?yes\r\n수정된 내용 적용되려면 실행해야함"),"\n"),"\n",r.createElement(n.p,null,"4-1 Add General API annotations in main.go(application.go) file"),"\n",r.createElement(n.pre,null,r.createElement(n.code,null,"// @title           Swagger Example API\r\n// @version         1.0\r\n// @description     This is a sample server celler server.\r\n// @termsOfService  http://swagger.io/terms/\r\n\r\n// @contact.name   API Support\r\n// @contact.url    http://www.swagger.io/support\r\n// @contact.email  support@swagger.io\r\n\r\n// @license.name  Apache 2.0\r\n// @license.url   http://www.apache.org/licenses/LICENSE-2.0.html\r\n\r\n// @host      localhost:8080\r\n// @BasePath  /api/v1\r\n// @Schemes http\r\n\r\nfunc main() {\n")),"\n",r.createElement(n.p,null,"4-2 Bearer token  설정"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"API key (as a header or a query string parameter)\r\n지금은 임시로 config 환경변수에 추가해서 지정값이 로그인시 토큰값으로 오면 config 값을 불러와 토큰으로 사용"),"\n"),"\n",r.createElement(n.p,null,"아래 태그를 쓴다면 다른 방법도 있을 거 같다 .."),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"@securityDefinitions.basic  BasicAuth"),"\n",r.createElement(n.li,null,"@securityDefinitions.apikey Bearer"),"\n"),"\n",r.createElement(n.p,null,"(질문)Difference between API key and Bearer token ?"),"\n",r.createElement(n.ol,{start:"5"},"\n",r.createElement(n.li,null,"\n",r.createElement(n.p,null,"main.go(application.go) 파일에 import 필수\r\n",r.createElement(n.code,null,'_ "test-service/docs""')," *test-service 는 프로젝트명)"),"\n"),"\n",r.createElement(n.li,null,"\n",r.createElement(n.p,null,"go run main.go 실행해서\r\n",r.createElement(n.code,null,"http://localhost:8000/swagger/index.html")," URL 접속"),"\n"),"\n"),"\n",r.createElement(n.h1,null,"참고"),"\n",r.createElement(n.p,null,r.createElement(n.a,{href:"https://wookiist.dev/103"},"https://wookiist.dev/103"),"\r\n",r.createElement(n.a,{href:"https://swagger.io/"},"https://swagger.io/"),"\r\n",r.createElement(n.a,{href:"https://stackoverflow.com/questions/65691081/swagger-generation-is-ignoring-securitydefiniton"},"https://stackoverflow.com/questions/65691081/swagger-generation-is-ignoring-securitydefiniton")))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?r.createElement(n,e,r.createElement(a,e)):a(e)},o=t(8804);function i(e){return r.createElement(o.Z,e,r.createElement(c,e))}o.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-c-github-gwiyeomgo-github-io-content-posts-server-golang-2023-03-13-go-echo-swagger-mdx-5858df07a69331e82716.js.map